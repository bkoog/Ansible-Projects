---
- name: IOSXE CONFIGURATION CONFIG VIA JINJA
  hosts: IOSXE
  connection: local
  gather_facts: no
  vars_files:
    - /opt/ansible/Ansible-Projects/iosxe_ansible_project/vars_files/intf_config_vars.yml

  # ansible-playbook -i inventory.yml playbook/intf_config_playbook.yml

  tasks:
    # - name: Generate IOS-XE Interfaces Config via jinja2 template
    #   template:
    #     src: "{{ item.src }}"
    #     dest: "{{ item.dest }}"
    #     mode: 0777
    #   with_items:
    #     - {src: '/opt/ansible/Ansible-Projects/iosxe_ansible_project/templates/intf_config.j2',
    #       dest: '/opt/ansible/Ansible-Projects/iosxe_ansible_project/outputs/intf_config_output.cfg'}
    #   register: output

    # - name: Configure IOS-XE via config file generated by above task 
    #   ios_config:
    #     src: /opt/ansible/Ansible-Projects/iosxe_ansible_project/templates/intf_config.j2
    #     backup: yes
    #     backup_options:
    #       filename: "{{ inventory_hostname }}.cfg"
    #       dir_path: /opt/ansible/Ansible-Projects/iosxe_ansible_project/backups
    #   when:
    #     - ansible_network_os == 'ios'
    #   register: output 

    - name: Configure IOS-XE via jinja2 tempalte
      ios_config:
        src: /opt/ansible/Ansible-Projects/iosxe_ansible_project/templates/intf_config.j2
        backup: yes
        backup_options:
          filename: "{{ inventory_hostname }}.cfg"
          dir_path: /opt/ansible/Ansible-Projects/iosxe_ansible_project/backups
      when:
        - ansible_network_os == 'ios'
      register: intf_config

    - name: Interface has been updated 
      debug:
        var: intf_config.updates

